#include <iostream>
#include <cstdlib>
#include <ctime>
using namespace std;

int main() {
	srand(time(0));
	int t, k, c;
	char e;
	int m[4][4] = { { 0,0,0,0 },{ 0,0,0,0 },{ 0,0,0,0 },{ 0,0,0,0 } };
	do {
		int o1 = rand() % 11;
		if (o1 < 10) { t = 2; }
		else { t = 4; }
		for (;;) {
			int o2 = rand() % 16;
			if (m[o2 / 4][o2 % 4] == 0) { m[o2 / 4][o2 % 4] = t; break; }
		}
		for (int i = 0; i < 4; i++) { cout << m[i][0] << ' ' << m[i][1] << ' ' << m[i][2] << ' ' << m[i][3] << endl; }
		cin >> e;
		switch (e) {
		case 's':
			for (int j = 3; j >= 0; j--) {
				for (int k = 0; k < 4; k++) {
					for (int i = 3; i > 0; i--) {
						if (m[i][j] == 0) {
							m[i][j] = m[i - 1][j];  m[i - 1][j] = 0;
						}
					}
				}
				for (int i = 3; i > 0; i--) {
					if (m[i][j] == m[i - 1][j]) {
						m[i][j] += m[i - 1][j];  m[i - 1][j] = 0;
					}
				}
				for (int i = 3; i > 0; i--) {
					if (m[i][j] == 0) {
						m[i][j] = m[i - 1][j];  m[i - 1][j] = 0;
					}
				}
			}
			break;

		case 'w':
			for (int j = 0; j < 4; j++) {
				for (int k = 0; k < 4; k++) {
					for (int i = 0; i < 3; i++) {
						if (m[i][j] == 0) {
							m[i][j] = m[i + 1][j];  m[i + 1][j] = 0;
						}
					}
				}
				for (int i = 0; i < 3; i++) {
					if (m[i][j] == m[i + 1][j]) {
						m[i][j] += m[i + 1][j]; m[i + 1][j] = 0;
					}
				}
				for (int i = 0; i < 3; i++) {
					if (m[i][j] == 0) {
						m[i][j] = m[i + 1][j];  m[i + 1][j] = 0;
					}
				}
			}
			break;

		case 'a':
			for (int i = 0; i < 4; i++) {
				for (int k = 0; k < 4; k++) {
					for (int j = 0; j < 3; j++) {
						if (m[i][j] == 0) {
							m[i][j] = m[i][j + 1]; m[i][j + 1] = 0;
						}
					}
				}
				for (int j = 0; j < 3; j++) {
					if (m[i][j] == m[i][j + 1]) {
						m[i][j] += m[i][j + 1]; m[i][j + 1] = 0;
					}
				}
				for (int j = 0; j < 3; j++) {
					if (m[i][j] == 0) {
						m[i][j] = m[i][j + 1]; m[i][j + 1] = 0;
					}
				}
			}
			break;

		case 'd':
			for (int i = 3; i >= 0; i--) {
				for (int k = 0; k < 4; k++) {
					for (int j = 3; j > 0; j--) {
						if (m[i][j] == 0) {
							m[i][j] = m[i][j - 1]; m[i][j - 1] = 0;
						}
					}
				}
				for (int j = 3; j > 0; j--) {
					if (m[i][j] == m[i][j - 1]) {
						m[i][j] += m[i][j - 1]; m[i][j - 1] = 0;
					}
				}
				for (int j = 3; j > 0; j--) {
					if (m[i][j] == 0) {
						m[i][j] = m[i][j - 1]; m[i][j - 1] = 0;
					}
				}
			}
				break;
		
		}
	}


	while (e != 'q');
	return 0;
}
