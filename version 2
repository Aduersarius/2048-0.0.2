#include <iostream>
#include <cstdlib>
#include <ctime>
using namespace std;

int main() {

srand(time(0));

	int t, k;

	char e;



	int m[4][4] = { { 0,0,0,0 },{ 0,0,0,0 },{ 0,0,0,0 },{ 0,0,0,0 } };



	do {



		int o1 = rand() % 11;

		if (o1 < 10) { t = 2; }

		else { t = 4; }

		for (;;) {

			int o2 = rand() % 16;



			if (m[o2 / 4][o2 % 4] == 0) { m[o2 / 4][o2 % 4] = t; break; }

		}



		for (int i = 0; i < 4; i++) { cout << m[i][0] << ' ' << m[i][1] << ' ' << m[i][2] << ' ' << m[i][3] << endl; }



		cin >> e;



		switch (e) {



		case 'j':



			k = 0;

			while (k < 4) {

				for (int i = 4; i > 0; i--) {

					for (int j = 0; j < 4; j++) {

						if (m[i - 1][j] == m[i][j] || m[i][j] == 0) {

							if (i != 0) {

								m[i][j] = m[i - 1][j] + m[i][j];

								m[i - 1][j] = 0;

							}

						}

					}

				}

				k++;

			}

			break;



		case 'k':

			k = 0;

			while (k < 4) {

				for (int i = 0; i < 4; i++) {

					for (int j = 0; j < 4; j++) {

						if (m[i][j] == m[i + 1][j] || m[i][j] == 0) {

							if (i != 3) {

								m[i][j] = m[i][j] + m[i + 1][j];

								m[i + 1][j] = 0;

							}

						}

					}

				}

				k++;

			}

			break;



		case 'h':



			k = 0;

			while (k < 4) {

				for (int i = 0; i < 4; i++) {

					for (int j = 0; j < 4; j++) {

						if (m[i][j] == m[i][j + 1] || m[i][j] == 0) {

							if (j != 3) {

								m[i][j] = m[i][j] + m[i][j + 1];

								m[i][j + 1] = 0;

							}

						}

					}

				}

				k++;

			}

			break;



		case 'l':



			k = 0;

			while (k <= 4) {

				for (int i = 0; i < 4; i++) {

					for (int j = 0; j < 4; j++) {

						if (m[i][4 - j] == m[i][3 - j] || m[i][4 - j] == 0) {

							if (j != 0) {

								m[i][4 - j] = m[i][4 - j] + m[i][3 - j];

								m[i][3 - j] = 0;

							}

						}

					}

				}

				k++;

			}

			break;



		}

	}

while (e != 'q');



	return 0;



}
